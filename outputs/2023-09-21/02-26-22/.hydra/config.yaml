basedir: logs
expname: anerf_prf_h36m_S9
num_workers: 16
sampler:
  _target_: core.datasets.samplers.RayImageSampler
N_rays: 3072
N_sample_images: 16
iters: 300000
N_samples: 48
N_imporantce: 32
i_print: 100
i_save: 10000
i_testset: 10000
render_factor: 1
trainer:
  optim:
    _target_: torch.optim.Adam
    lr: 0.0005
  lr_sched:
    decay_type: standard
    decay_steps: 500000
    decay_rate: 0.1
    delay_steps: 2000
  pose_opt: true
losses:
  NeRFRGBLoss:
    fine: 1.0
    coarse: 1.0
model:
  _target_: core.networks.anerf.ANeRF
  D: 8
  W: 256
  view_W: 128
  skips:
  - 4
  use_framecodes: true
  framecode_ch: 128
  pts_embedder:
    _target_: core.embedder.SkeletonRelativeEmbedder
  pts_posi_enc:
    _target_: core.positional_enc.CutoffPositionalEncoding
    num_freqs: 8
  view_embedder:
    _target_: core.embedder.SkeletonRelativeViewEmbedder
  view_posi_enc:
    _target_: core.positional_enc.CutoffPositionalEncoding
    num_freqs: 4
  raycaster:
    _target_: core.raycast.RayCast
    N_samples: 48
    N_importance: 32
  pose_opt:
    _target_: core.networks.pose_opt.PoseOpt
dataset:
  _target_: core.datasets.ZJUH36MDataset
  h5_path: data/h36m_zju/${.subject}_train.h5
  split: train
  patch_size: 1
  subject: S9
  mask_img: true
  perturb_bg: true
